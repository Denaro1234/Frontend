<!-- dump.component.html -->
<div class="page-container">
  <div class="page-header">
    <h1>Dump Sheet</h1>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="addRow()">
        <i class="fas fa-plus"></i> Add Entry
      </button>
      <button class="btn btn-secondary" (click)="navigateToEdit()">
        <i class="fas fa-edit"></i> Edit Entry
      </button>
      <button class="btn btn-success" (click)="updateAllEditedRows()">
        <i class="fas fa-sync-alt"></i> Update
      </button>
    </div>
  </div>
  <div class="card">
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th class="text-center">ID</th>
            <th class="text-center">Lead Source</th>
            <th class="text-center">Dumped Date</th>
            <th class="text-center">Comments</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of dumpSheetData; let i = index" [class.editing]="row.editing || row.isNew">
            <td class="text-center">{{row.Dump_ID || 'New'}}</td>
            <td class="text-center">
              <input *ngIf="row.editing || row.isNew" type="text" class="form-control text-center" [(ngModel)]="row.Lead_Source_Code">
              <ng-container *ngIf="!row.editing && !row.isNew">{{row.Lead_Source_Code}}</ng-container>
            </td>
            <td class="text-center">
              <input *ngIf="row.editing || row.isNew" type="datetime-local" class="form-control text-center" [(ngModel)]="row.Dumped_Date">
              <ng-container *ngIf="!row.editing && !row.isNew">{{row.Dumped_Date | date:'short'}}</ng-container>
            </td>
            <td class="text-center">
              <input *ngIf="row.editing || row.isNew" type="text" class="form-control text-center" [(ngModel)]="row.Comments">
              <ng-container *ngIf="!row.editing && !row.isNew">{{row.Comments}}</ng-container>
            </td>
            <td class="text-center actions">
              <ng-container *ngIf="row.isNew">
                <button class="btn btn-icon text-success" (click)="updateRow(row)" title="Save">
                  <i class="fas fa-check"></i>
                </button>
                <button class="btn btn-icon text-danger" (click)="cancelAdd(row)" title="Cancel">
                  <i class="fas fa-times"></i>
                </button>
              </ng-container>
              <ng-container *ngIf="!row.isNew && !row.editing">
                <button class="btn btn-icon text-info" (click)="editRow(i)" title="Edit">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-icon text-danger" (click)="deleteRow(row.Dump_ID)" title="Delete">
                  <i class="fas fa-trash"></i>
                </button>
              </ng-container>
              <ng-container *ngIf="!row.isNew && row.editing">
                <button class="btn btn-icon text-success" (click)="updateRow(row)" title="Save">
                  <i class="fas fa-check"></i>
                </button>
                <button class="btn btn-icon text-danger" (click)="cancelAdd(row)" title="Cancel">
                  <i class="fas fa-times"></i>
                </button>
              </ng-container>
            </td>
          </tr>
          <tr *ngIf="dumpSheetData.length === 0">
            <td colspan="5" class="text-center py-4">
              <div class="empty-state">
                <i class="fas fa-inbox fa-3x"></i>
                <p>No entries found</p>
                <button class="btn btn-primary" (click)="addRow()">Add First Entry</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
